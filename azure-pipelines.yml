# OpenCue Build and Test Pipeline

# Trigger the pipeline on every commit to master. Pull Requests to any branch will trigger
# the pipeline as well, by default.
trigger:
- master

jobs:
- job: build
  displayName: Build
  pool:
    vmImage: 'ubuntu-16.04'
  steps:
  - bash: |
      ci/generate_version_number.sh
      echo "##vso[task.setvariable variable=buildId;isOutput=true]$(cat ./VERSION)"
    name: setBuildId
  - bash: docker build -t opencue/cuebot:$(setBuildId.buildId) -f cuebot/Dockerfile .
    name: cuebot
  - bash: docker build -t opencue/rqd:$(setBuildId.buildId) -f rqd/Dockerfile .
    name: rqd
  - bash: docker build -t opencue/pycue:$(setBuildId.buildId) -f pycue/Dockerfile .
    name: pycue
