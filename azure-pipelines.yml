# OpenCue Build and Test Pipeline

# Trigger the pipeline on every commit to master. Pull Requests to any branch will trigger
# the pipeline as well, by default.
trigger:
- master

stages:
- stage: Environment
  jobs:
  - job: setBuildId
    displayName: Set Build Id
    pool:
      vmImage: 'ubuntu-16.04'
    steps:
    - bash: |
        ci/generate_version_number.sh
        echo "##vso[task.setvariable variable=buildId;isOutput=true]$(cat ./VERSION)"
      name: setBuildId
    - bash: echo $(setBuildId.buildId)
      name: echovar

- stage: Build
  jobs:
  - job: buildCuebot
    displayName: Build Cuebot
    pool:
      vmImage: 'ubuntu-16.04'
    steps:
    - bash: echo $(setBuildId.buildId)
      name: echovar
