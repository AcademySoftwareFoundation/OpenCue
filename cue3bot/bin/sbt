#!/bin/sh

export FILE_SEQUENCE_PATH=/shots/spi/home/lib/SpComp2/FileSequence/rhel7-gcc48m64/v6/lib
# ORACLE_HOME should match project/build.scala
export ORACLE_HOME=/usr/lib/oracle/12.1
export LD_LIBRARY_PATH=${ORACLE_HOME}
export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:${ORACLE_HOME}/client64/lib
export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:${FILE_SEQUENCE_PATH}
export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/lib64
export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/share
export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/lib
export TNS_ADMIN=/opt/tns

project_dir=$(readlink -f $(dirname $0)/..)

exec \
  /usr/bin/java \
    -Dcatalina.base=$project_dir \
    -XX:+UseParNewGC \
    -XX:+UseConcMarkSweepGC \
    -XX:+CMSClassUnloadingEnabled \
    -XX:CMSInitiatingOccupancyFraction=70 \
    -verbose:gc \
    -XX:+PrintGCDateStamps \
    -XX:+PrintGCDetails \
    -XX:+PrintGCTimeStamps \
    -XX:+PrintHeapAtGC \
    -XX:+PrintTenuringDistribution \
    -Xloggc:${project_dir}/logs/gc.log \
    -XX:+UseGCLogFileRotation \
    -XX:NumberOfGCLogFiles=10 \
    -XX:GCLogFileSize=1M \
    -Dfile.encoding=UTF8 \
    -Djava.net.preferIPv4Stack=true \
    -Xms3G \
    -Xmx3G \
    -XX:+CMSClassUnloadingEnabled \
    -XX:ReservedCodeCacheSize=192m \
    $EXTRA_JVM_OPTS \
    -jar `dirname $0`/sbt-launch.jar \
      "$@"
